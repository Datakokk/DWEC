<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Referencias Cruzadas</title>
</head>
<body>
    <script>
            let referenciasCruzadas = `Guerra tenia una parra y Parra tenia una perra
                la perra de Parra rompio la parra de Guerra y Guerra aporreo con la porra a la perra
                Si la perra de Parra no hubiera roto la parra de Guerra
                este no hubiera aporreado con la porra a la perra de Parra
                `;

            let arrGrande = referenciasCruzadas
                                .split('\n')
                                .map(reg => reg
                                            .trim()
                                            .toLowerCase()
                                            .split(' '))
                                .filter(reg => Boolean(reg[0]));
            
            let ObjFinal = arrGrande.reduce((obj,reg,indice)=>{
                let objLinea = reg
                                .filter(palabra => palabra.length > 2)
                                .reduce((obj,palabra) =>{
                                    obj[palabra] = obj[palabra] || indice + 1;
                                    return obj;
                                },{})
                    let palabras = Object.keys(objLinea);

                    for (let i = 0; i < palabras.length; i++) {
                        obj[palabras[i]] = obj[palabras[i]] || [];
                        obj[palabras[i]].push(objLinea[palabras[i]]);
                        
                    }

                    return obj;
            },{})

            
    </script>
</body>
</html>